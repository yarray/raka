{
  "scopeName": "raka-python.injection",
  "injectionSelector": "L:source.ruby",
  "patterns": [
    {
      "begin": "(?><<[-~](\"?)((?:[_\\w]+_|)PYTHON)\\b\\1)",
      "beginCaptures": {
        "0": {
          "name": "punctuation.definition.string.begin.ruby"
        }
      },
      "contentName": "meta.embedded.python",
      "end": "\\s*\\2$\\n?",
      "endCaptures": {
        "0": {
          "name": "punctuation.definition.string.end.ruby"
        }
      },
      "name": "meta.embedded.block",
      "patterns": [
        {
          "include": "#heredoc"
        },
        {
          "include": "#interpolated_ruby"
        },
        {
          "include": "#escaped_char"
        },
        {
          "include": "source.python"
        }
      ]
    }
  ],
  "repository": {
    "escaped_char": {
      "match": "\\\\(?:[0-7]{1,3}|x[\\da-fA-F]{1,2}|.)",
      "name": "constant.character.escape.ruby"
    },
    "heredoc": {
      "begin": "^<<[-~]?\\w+",
      "end": "$",
      "patterns": [
        {
          "include": "$self"
        }
      ]
    },
    "interpolated_ruby": {
      "patterns": [
        {
          "begin": "#\\{",
          "beginCaptures": {
            "0": {
              "name": "punctuation.section.embedded.begin.ruby"
            }
          },
          "contentName": "source.ruby",
          "end": "(\\})",
          "endCaptures": {
            "0": {
              "name": "punctuation.section.embedded.end.ruby"
            },
            "1": {
              "name": "source.ruby"
            }
          },
          "name": "meta.embedded.line.ruby",
          "patterns": [
            {
              "include": "#nest_curly_and_self"
            },
            {
              "include": "source.ruby"
            }
          ],
          "repository": {
            "nest_curly_and_self": {
              "patterns": [
                {
                  "begin": "\\{",
                  "captures": {
                    "0": {
                      "name": "punctuation.section.scope.ruby"
                    }
                  },
                  "end": "\\}",
                  "patterns": [
                    {
                      "include": "#nest_curly_and_self"
                    }
                  ]
                },
                {
                  "include": "source.ruby"
                }
              ]
            }
          }
        },
        {
          "captures": {
            "1": {
              "name": "punctuation.definition.variable.ruby"
            }
          },
          "match": "(#@)[a-zA-Z_]\\w*",
          "name": "variable.other.readwrite.instance.ruby"
        },
        {
          "captures": {
            "1": {
              "name": "punctuation.definition.variable.ruby"
            }
          },
          "match": "(#@@)[a-zA-Z_]\\w*",
          "name": "variable.other.readwrite.class.ruby"
        },
        {
          "captures": {
            "1": {
              "name": "punctuation.definition.variable.ruby"
            }
          },
          "match": "(#\\$)[a-zA-Z_]\\w*",
          "name": "variable.other.readwrite.global.ruby"
        }
      ]
    }
  }
}
